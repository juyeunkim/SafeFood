<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="food" >
  <insert id="insert"		parameterType="food">
   		insert into food (code, name, supportpereat, calory, carbo,protein
   		,fat,sugar,natrium,chole,fattyacid,transfat,maker,material,img,allergy)
   		values ( #{code:INTEGER} ,#{name:VARCHAR}
   				,#{supportpereat:DOUBLE}
   				,#{calory:DOUBLE}
   				,#{carbo:DOUBLE}
   				,#{protein:DOUBLE}
   				,#{fat:DOUBLE}
   				,#{sugar:DOUBLE}
   				,#{natrium:DOUBLE}
   				,#{chole:DOUBLE}
   				,#{fattyacid:DOUBLE}
   		        ,#{transfat:DOUBLE}
   		        ,#{maker:VARCHAR}
   		        ,#{material:VARCHAR}
   		        ,#{img:VARCHAR}
   		        ,#{contents:VARCHAR}
   		        ,#{allergy:VARCHAR})
   </insert>
   
   <delete id="delete" 		parameterType="int">
   		delete from food where code=#{code}
   </delete>
   
   <update id="update"		parameterType="food">
   		update food set name = #{name:VARCHAR}, supportpereat = #{supportpereat:DOUBLE}
   		, calory = #{calory:DOUBLE}, carbo = #{carbo:DOUBLE},protein = #{protein:DOUBLE}
   		,fat = #{fat:DOUBLE},sugar = #{sugar:DOUBLE},natrium = #{natrium:DOUBLE},chole = #{chole:DOUBLE}
   		,fattyacid = #{fattyacid:DOUBLE} ,transfat = #{transfat:DOUBLE}
   		,maker = #{maker:VARCHAR},material = #{material:VARCHAR},img = #{contents:VARCHAR},allergy = #{allergy:VARCHAR}
   		where  code = #{code:INTEGER}
   </update>
   
   <select id="search"		 parameterType="int"    resultType="food">
   		select *
   		from food  where code=#{code}
   </select>
   
   <select id="searchAll"	parameterType="pagebean"	resultType="food">
   		select *
   		from food 
   		<!-- 동적 쿼리시 조건에 의해 where 나 and를 붙여주는 태그  -->
   		<where>
   			<if test='key != null and key!="all"'>
   				<if test=" word != null">
   					<choose>
   						<when test="key == 'code'">
   							id = #{word}
   						</when>
   						<when test="key == 'name'">
   							name like  concat('%',#{word},'%')
   						</when>
   						<when test="key == 'maker'">
   							maker like  concat('%',#{word},'%')
   						</when>
   						<when test="key == 'material'">
   							material like  concat('%',#{word},'%')
   						</when>
   					</choose>
   				</if>
   			</if>
   		</where>
   		order by code desc 
   </select>
   <select id="count"	resultType="int"	parameterType="pagebean">
   		select count(*) as cnt from food
   		<where>
   			<if test='key != null and key!="all"'>
   				<if test=" word != null">
   					<choose>
   						<when test="key == 'code'">
   							id = #{word}
   						</when>
   						<when test="key == 'name'">
   							name like  concat('%',#{word},'%')
   						</when>
   						<when test="key == 'maker'">
   							maker like  concat('%',#{word},'%')
   						</when>
   						<when test="key == 'material'">
   							material like  concat('%',#{word},'%')
   						</when>
   					</choose>
   				</if>
   			</if>
   		</where>
   </select>
   
</mapper>
























































	












